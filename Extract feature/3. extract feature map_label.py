import pandas as pd
import csv
import re
import glob
map_num = {'0_apps': 0, 'AccuTrack': 1, 'Ackposts': 2, 'Acnetdoor': 3,
           'Adrd': 4, 'Adsms': 5, 'Aks': 6, 'Ansca': 7, 'Antares': 8, 'Anti': 9,
           'Anudow': 10, 'Arspam': 11, 'BaseBridge': 12, 'BeanBot': 13,
           'Bgserv': 14, 'Biige': 15, 'Booster': 16, 'Bosm': 17, 'Boxer': 18,
           'Cawitt': 19, 'CellShark': 20, 'CellSpy': 21, 'Ceshark': 22,
           'CgFinder': 23, 'Coogos': 24, 'Copycat': 25, 'Cosha': 26,
           'CrWind': 27, 'Dabom': 28, 'Dialer': 29, 'Dogowar': 30,
           'Dougalek': 31, 'DroidDream': 32, 'DroidKungFu': 33,
           'DroidRooter': 34, 'DroidSheep': 35, 'EICAR-Test-File': 36,
           'EWalls': 37, 'Exploit.RageCage': 38, 'ExploitLinuxLotoor': 39,
           'Faceniff': 40, 'FakeDoc': 41, 'FakeFlash': 42, 'FakeInstaller': 43,
           'Fakelogo': 44, 'FakeNefix': 45, 'Fakengry': 46, 'FakePlayer': 47,
           'FakeRun': 48, 'FakeTimer': 49, 'Fakeview': 50, 'FarMap': 51,
           'Fatakr': 52, 'Fauxcopy': 53, 'Fidall': 54, 'FinSpy': 55,
           'Fjcon': 56, 'Flexispy': 57, 'FoCobers': 58, 'Foncy': 59, 'Fsm': 60,
           'Fujacks': 61, 'Gamex': 62, 'Gapev': 63, 'Gappusin': 64, 'Gasms': 65,
           'Geinimi': 66, 'Generic': 67, 'GGtrack': 68, 'GinMaster': 69,
           'GlodEagl': 70, 'Glodream': 71, 'Gmuse': 72, 'Gonca': 73,
           'GPSpy': 74, 'Hamob': 75, 'Hispo': 76, 'Iconosys': 77, 'Imlog': 78,
           'Jifake': 79, 'JS/Exploit-DynSrc': 80, 'Exploit-DynSrc': 81, 'JSmsHider': 82,
           'Kidlogger': 83, 'Kiser': 84, 'Kmin': 85, 'Koomer': 86, 'Ksapp': 87,
           'Lemon': 88, 'LifeMon': 89, 'Loicdos': 90, 'Loozfon': 91,
           'Luckycat': 92, 'Lypro': 93, 'Maistealer': 94, 'Mania': 95,
           'Maxit': 96, 'MMarketPay': 97, 'Mobilespy': 98, 'MobileTx': 99,
           'Mobinauten': 100, 'Mobsquz': 101, 'Moghava': 102,'MTracker': 103,
           'Nandrobox': 104, 'Netisend': 105, 'Nickspy': 106, 'NickyRCP': 107,
           'Nisev': 108, 'Nyleaker': 109, 'Opfake': 110, 'PdaSpy': 111,
           'Penetho': 112, 'Pirater': 113, 'Pirates': 114, 'PJApps': 115,
           'Placms': 116, 'Plankton': 117, 'Proreso': 118, 'Qicsom': 119,
           'QPlus': 120, 'Raden': 121, 'RATC': 122, 'RediAssi': 123,
           'Replicator': 124, 'Rooter': 125, 'RootSmart': 126, 'RuFraud': 127,
           'SafeKidZone': 128, 'Saiva': 129, 'Sakezon': 130, 'Sdisp': 131,
           'SeaWeth': 132, 'SendPay': 133, 'SerBG': 134, 'SheriDroid': 135,
           'SmForw': 136, 'SMSBomber': 137, 'Smspacem': 138, 'SMSreg': 139,
           'SMSSend': 140, 'SmsSpy': 141, 'SmsWatcher': 142, 'SMSZombie': 143,
           'Sonus': 144, 'Spitmo': 145, 'Spy.GoneSixty': 146, 'Spy.ImLog': 147,
           'SpyBubble': 148, 'SpyHasb': 149, 'SpyMob': 150, 'Spyoo': 151,
           'SpyPhone': 152, 'Spyset': 153, 'Ssmsp': 154, 'Stealer': 155,
           'Stealthcell': 156, 'Steek': 157, 'Stiniter': 158, 'SuBatt': 159,
           'Tapsnake': 160, 'Tesbo': 161, 'TheftAware': 162, 'TigerBot': 163,
           'Trackplus': 164, 'TrojanSMS.Boxer.AQ': 165,
           'TrojanSMS.Denofow': 166, 'TrojanSMS.Hippo': 167,
           'TrojanSMS.Stealer': 168, 'Typstu': 169, 'Updtbot': 170,
           'UpdtKiller': 171, 'Vdloader': 172, 'Vidro': 173, 'Whapsni': 174,
           'Xsider': 175, 'YcChar': 176, 'Yzhc': 177, 'Zitmo': 178, 'Zsone': 179,
           'Airpush': 180, 'AndroRAT': 181, 'Andup': 182, 'Aples':183, 'BankBot': 184,
           'Boqx': 185, 'Cova': 186, 'Dowgin': 187, 'Erop': 188, 'FakeAngry': 189, 
           'FakeAV': 190, 'FakeInst': 191, 'Fobus': 192, 'Fusob': 193, 'GingerMaster': 194,
           'GoldDream': 195, 'Gumen':196, 'Jisut': 197, 'Koler': 198, 'Kuguo': 199, 
           'Kyview': 200, 'Lnk': 201, 'Lotoor': 202, 'Mecor': 203, 'Minimob': 204, 'Mmarketpay': 205,
           'MobileTX': 206, 'Mseg': 207, 'Mtk': 208, 'Obad': 209, 'Ogel': 210, 'Ramnit': 211,
           'Roop': 212, 'SimpleLocker': 213, 'SlemBunk': 214, 'SmsKey': 215, 'SmsZombie': 216,
           'Spambot': 217, 'Svpeng': 218, 'Triada': 219, 'Univert': 220, 'Utchi': 221, 
           'VikingHorde': 222, 'Vmvol': 223, 'Winge': 224, 'Youmi': 225, 'Ztorg': 226, 'Finspy':227}
i = 0
temp_row = [0,1,2,3,4,5,6]

a = pd.read_csv('nhandrebin.csv', header=None, index_col=0, squeeze=True).to_dict()




writer = csv.writer(open("G:\\1a. NCKH\\AMD\\AMD_128.csv", 'w', newline = ''))
list_file = glob.glob("G:\\1a. NCKH\\AMD\\AMD_128\\*.csv")

for each_file in list_file:
  f = open(each_file, 'r')
  reader = csv.reader(f)
  for row in reader:
    temp_row[0] = row[0].split("\\")[-1].split(".apk")[0]
    temp_row[1] = row[0].split("\\")[4]
    temp_row[2] = map_num.get(temp_row[1])
    temp_row[3:] = row[1:]  
    writer.writerow(temp_row)
    
    i += 1
    print(i)
print(i)


